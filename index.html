<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BlazeCraft | Real-Time AI Agent Command Center</title>
  <meta name="description" content="Monitor and control Claude Code sessions in real-time. BlazeCraft gives you RTS-style command over AI agents ‚Äî track progress, tokens, and tasks across multiple workers." />
  <meta name="theme-color" content="#0b0b0f" />
  <meta name="keywords" content="Claude Code, AI agents, task monitoring, developer tools, real-time dashboard" />

  <!-- Open Graph -->
  <meta property="og:title" content="BlazeCraft | Real-Time AI Agent Command Center" />
  <meta property="og:description" content="Monitor and control Claude Code sessions in real-time. Track progress, tokens, and tasks across multiple AI workers with an RTS-style command interface." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://blazecraft.app" />

  <!-- Fonts: Plus Jakarta Sans, Cinzel (WC3 display), Lora (WC3 body), JetBrains Mono -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Archivo+Black&family=Cinzel:wght@400;700&family=Cinzel+Decorative:wght@700&family=Lora:ital,wght@0,400;0,600;1,400&family=JetBrains+Mono:wght@400;500;700&family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=MedievalSharp&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="styles/main.css" />
</head>
<body>
  <!-- Skip link for keyboard accessibility -->
  <a href="#mapWrap" class="skip-link">Skip to main content</a>

  <!-- BSI Film Grain Filter (3.5% opacity, respects prefers-reduced-motion) -->
  <svg class="bsi-grain-defs" aria-hidden="true" style="position:absolute;width:0;height:0;pointer-events:none;">
    <defs>
      <filter id="bsi-grain-filter" x="0%" y="0%" width="100%" height="100%">
        <feTurbulence type="fractalNoise" baseFrequency="0.75" numOctaves="4" stitchTiles="stitch" result="noise"/>
        <feColorMatrix type="saturate" values="0" result="mono"/>
        <feBlend in="SourceGraphic" in2="mono" mode="multiply"/>
      </filter>
    </defs>
  </svg>

  <!-- Film Grain Overlay (can toggle via BSIGrain.disable()) -->
  <div id="bsi-grain-overlay" class="bsi-grain-overlay" aria-hidden="true"></div>

  <!-- WC3 Magical Wisp Particle Container -->
  <div id="wc3-wisps" class="wc3-wisps-container" aria-hidden="true"></div>

  <div id="app" aria-label="BlazeCraft">

    <!-- Welcome Overlay (first-time visitors) -->
    <div id="welcomeOverlay" class="welcome-overlay" role="dialog" aria-labelledby="welcomeTitle" aria-modal="true">
      <div class="welcome-card">
        <div class="welcome-header">
          <span class="welcome-icon" aria-hidden="true">üî•</span>
          <h1 id="welcomeTitle" class="welcome-title">BlazeCraft</h1>
          <p class="welcome-tagline">Real-Time AI Agent Command Center</p>
        </div>
        <div class="welcome-content">
          <p class="welcome-desc">Monitor and control your Claude Code sessions with an RTS-style command interface. Track tasks, tokens, and progress across multiple AI workers in real-time.</p>
          <div class="welcome-features">
            <div class="welcome-feature">
              <span class="welcome-feature-icon" aria-hidden="true">üéØ</span>
              <span class="welcome-feature-text">Track task progress in real-time</span>
            </div>
            <div class="welcome-feature">
              <span class="welcome-feature-icon" aria-hidden="true">‚ö°</span>
              <span class="welcome-feature-text">Monitor multiple agents at once</span>
            </div>
            <div class="welcome-feature">
              <span class="welcome-feature-icon" aria-hidden="true">üéÆ</span>
              <span class="welcome-feature-text">Command your workers like an RTS game</span>
            </div>
          </div>
        </div>
        <div class="welcome-actions">
          <button id="welcomeDemo" class="btn btn-accent" type="button">Start Demo</button>
          <button id="welcomeDismiss" class="btn btn-secondary" type="button">Skip Intro</button>
        </div>
        <p class="welcome-hint">Press <kbd>Esc</kbd> or click outside to close</p>
      </div>
    </div>

    <!-- WC3 Resource Bar (Top) - Task-focused metrics -->
    <header id="topbar" class="panel wc3-resource-bar" role="banner">
      <div class="topbar-left">
        <!-- Task Metrics - Primary stats display -->
        <div class="wc3-task-metrics" role="group" aria-label="Task Metrics">
          <div class="wc3-metric" title="Tasks Completed">
            <span class="wc3-metric-ico tasks" aria-hidden="true">ü™ô</span>
            <span class="wc3-metric-label">Tasks Completed:</span>
            <span id="resCompleted" class="wc3-metric-num">0</span>
          </div>
          <div class="wc3-metric" title="Files Modified">
            <span class="wc3-metric-ico files" aria-hidden="true">üìÑ</span>
            <span class="wc3-metric-label">Files Modified:</span>
            <span id="resFiles" class="wc3-metric-num">0</span>
          </div>
          <div class="wc3-metric" title="Active Workers">
            <span class="wc3-metric-ico workers" aria-hidden="true">‚ö°</span>
            <span class="wc3-metric-label">Active Workers:</span>
            <span id="resWorkers" class="wc3-metric-num">0</span>
          </div>
          <div class="wc3-metric wc3-metric-failed" title="Failed Tasks">
            <span class="wc3-metric-ico failed" aria-hidden="true">üëπ</span>
            <span class="wc3-metric-label">Failed Tasks:</span>
            <span id="resFailed" class="wc3-metric-num">00</span>
          </div>
          <div class="wc3-metric" title="Tokens Spent">
            <span class="wc3-metric-ico tokens" aria-hidden="true">üí∞</span>
            <span class="wc3-metric-label">Tokens Spent:</span>
            <span id="resTokens" class="wc3-metric-num">0</span>
          </div>
        </div>
      </div>

      <div class="topbar-center">
        <button id="idleAlert" class="idle-alert-enhanced" type="button" aria-live="polite" hidden>
          <span class="idle-alert-icon" aria-hidden="true">üò¥</span>
          <span class="idle-alert-label">Idle Workers:</span>
          <span id="idleAlertCount" class="idle-alert-num">0</span>
        </button>
      </div>

      <div class="topbar-right">
        <div class="mode-selector" role="group" aria-label="View mode">
          <button id="modeRTS" class="mode-btn active" type="button" aria-label="RTS mode">RTS</button>
          <button id="modeOps" class="mode-btn" type="button" aria-label="Operations mode">Ops</button>
        </div>
        <button id="toggleLog" class="btn btn-sm" type="button" aria-pressed="false">Log</button>
        <button id="toggleDemo" class="btn btn-accent btn-sm" type="button" aria-pressed="true" title="Toggle demo mode">Demo</button>
      </div>
    </header>

    <!-- WC3 Game Area (Map + Event Log) -->
    <div class="wc3-game-area">
      <!-- Center Map -->
      <main id="mapWrap" class="panel wc3-map-panel" role="main">
        <canvas id="mapCanvas" width="1280" height="720" aria-label="Workspace Map" tabindex="0"></canvas>
        <div id="mapHud" class="hud" aria-hidden="true">
          <div class="hud-row">
            <span class="kbd">Drag</span> select
            <span class="dot">¬∑</span>
            <span class="kbd">RMB</span> assign
            <span class="dot">¬∑</span>
            <span class="kbd">Wheel</span> zoom
            <span class="dot">¬∑</span>
            <span class="kbd">MMB</span> pan
          </div>
        </div>
      </main>

      <!-- Event Log (Right Sidebar) -->
      <aside id="logPanel" class="panel wc3-event-log" aria-label="Event Log">
        <div class="panel-title">
          <span>Event Log</span>
          <span id="logStatus" class="tag tag-live">Live</span>
        </div>
        <div id="logFeed" class="log-feed" role="log" aria-live="polite">
          <!-- Loading state (shown during initial connection) -->
          <div id="logLoading" class="state-container state-loading">
            <div class="state-loading-spinner" aria-hidden="true"></div>
            <span class="state-loading-text">Connecting to event stream...</span>
          </div>
          <!-- Empty state (shown when connected but no events) -->
          <div id="logEmpty" class="state-container state-empty" hidden>
            <span class="state-empty-icon" aria-hidden="true">üì≠</span>
            <span class="state-empty-text">No events yet. Workers will report here.</span>
          </div>
          <!-- Error state (shown on connection failure) -->
          <div id="logError" class="state-container state-error" hidden>
            <span class="state-error-icon" aria-hidden="true">‚ö†Ô∏è</span>
            <span class="state-error-text">Connection lost.</span>
            <button id="logRetry" class="state-retry-btn" type="button">Retry</button>
          </div>
        </div>
      </aside>
    </div>

    <!-- WC3 Bottom HUD - Enhanced Layout -->
    <section id="bottomHud" class="panel wc3-hud-bottom-enhanced" aria-label="Bottom HUD">

      <!-- Portrait Panel - Enhanced WC3 Style with Ornate Frame -->
      <div class="wc3-portrait-panel-enhanced">
        <div class="wc3-portrait-frame-ornate">
          <div class="wc3-portrait-frame-ring"></div>
          <div class="wc3-portrait-frame-inner">
            <div id="portraitAvatar" class="wc3-portrait-avatar">
              <div id="portraitIcon" class="wc3-portrait-icon-img">ü§ñ</div>
            </div>
          </div>
          <div class="wc3-portrait-frame-corners"></div>
        </div>
        <div class="wc3-portrait-details">
          <div id="portraitName" class="wc3-portrait-name-large">Subagent-7</div>
          <div id="portraitTask" class="wc3-portrait-task">Refactoring src/utils</div>
          <div class="wc3-progress-bar-container">
            <div class="wc3-progress-bar">
              <div id="portraitMeter" class="wc3-progress-fill" style="width: 45%"></div>
            </div>
            <span id="portraitProgress" class="wc3-progress-pct">45%</span>
          </div>
          <div class="wc3-portrait-stats">
            <div class="wc3-portrait-stat">
              <span class="wc3-stat-label">Time:</span>
              <span id="portraitElapsed" class="wc3-stat-value">00:12</span>
            </div>
            <div class="wc3-portrait-stat">
              <span class="wc3-stat-label">Tokens:</span>
              <span id="portraitTokens" class="wc3-stat-value">320</span>
            </div>
          </div>
        </div>
        <button id="portraitExpand" class="wc3-portrait-expand" type="button" aria-label="Expand details">
          <span aria-hidden="true">+</span>
        </button>
      </div>

      <!-- Selection Summary Panel -->
      <div id="selectionPanel" class="wc3-selection-panel" aria-live="polite" hidden>
        <div class="wc3-selection-header">
          <div class="wc3-selection-heading">
            <span id="selectionCount" class="wc3-selection-count">0</span>
            <span id="selectionLabel" class="wc3-selection-label">Units selected</span>
          </div>
          <div id="selectionFeedback" class="wc3-selection-feedback" aria-hidden="true" hidden>
            <span id="selectionFeedbackIcon" class="wc3-selection-feedback-icon">‚úì</span>
            <span id="selectionFeedbackText" class="wc3-selection-feedback-text">Order received</span>
          </div>
        </div>
        <div id="selectionTypes" class="wc3-selection-types"></div>
        <div class="wc3-selection-stats">
          <div class="wc3-selection-stat">
            <span class="wc3-selection-stat-label">Task %</span>
            <span id="selectionAvgProgress" class="wc3-selection-stat-value">--</span>
          </div>
          <div class="wc3-selection-stat">
            <span class="wc3-selection-stat-label">Tokens</span>
            <span id="selectionAvgTokens" class="wc3-selection-stat-value">--</span>
          </div>
        </div>
      </div>

      <!-- Minimap Panel -->
      <div class="wc3-minimap-panel">
        <div class="wc3-minimap-frame">
          <canvas id="minimapCanvas" width="180" height="140" aria-label="Minimap"></canvas>
        </div>
        <div class="wc3-minimap-btns" role="group" aria-label="Minimap controls">
          <button class="wc3-minimap-btn" data-action="terrain" aria-label="Toggle terrain view">Ter</button>
          <button class="wc3-minimap-btn" data-action="units" aria-label="Toggle unit view">Unit</button>
          <button class="wc3-minimap-btn" data-action="ping" aria-label="Ping location">Ping</button>
        </div>
      </div>

      <!-- Ops Feed Panel -->
      <div id="opsPanel" class="wc3-ops-panel">
        <div class="wc3-ops-header">
          <span class="wc3-ops-title">Ops Feed</span>
          <span id="opsStatus" class="tag tag-live">Live</span>
        </div>
        <div id="opsFeed" class="wc3-ops-feed">
          <!-- Loading state -->
          <div id="opsLoading" class="state-container state-loading">
            <div class="state-loading-spinner" aria-hidden="true"></div>
            <span class="state-loading-text">Connecting to BSI...</span>
          </div>
          <!-- Empty state -->
          <div id="opsEmpty" class="state-container state-empty" hidden>
            <span class="state-empty-text">No activity yet.</span>
          </div>
          <!-- Error state -->
          <div id="opsError" class="state-container state-error" hidden>
            <span class="state-error-text">Connection failed.</span>
            <button id="opsRetry" class="state-retry-btn" type="button">Retry</button>
          </div>
        </div>
        <div class="wc3-ops-stats">
          <div class="wc3-ops-stat">
            <span class="wc3-ops-stat-label">Latency</span>
            <span id="opsLatency" class="wc3-ops-stat-val">--</span>
          </div>
          <div class="wc3-ops-stat">
            <span class="wc3-ops-stat-label">Events</span>
            <span id="opsEvents" class="wc3-ops-stat-val">0</span>
          </div>
          <div class="wc3-ops-stat">
            <span class="wc3-ops-stat-label">Errors</span>
            <span id="opsErrors" class="wc3-ops-stat-val">0</span>
          </div>
        </div>
        <!-- BSI Health Status -->
        <div id="healthPanel" class="wc3-health-panel" role="status" aria-live="polite" aria-label="BSI Service Status">
          <!-- Normal health indicator -->
          <div id="healthNormal" class="wc3-health-indicator">
            <span class="wc3-health-dot" id="healthDot" data-status="unknown" aria-hidden="true"></span>
            <span class="wc3-health-label" id="healthLabel">BSI Status:</span>
            <span id="healthStatus" class="wc3-health-status" aria-describedby="healthLabel">Checking...</span>
          </div>
          <div id="healthDetails" class="wc3-health-details">
            <span class="wc3-health-latency">Latency: <span id="healthLatency" aria-label="Latency in milliseconds">--</span>ms</span>
          </div>
          <!-- Error state with retry -->
          <div id="healthError" class="state-container state-error" hidden>
            <span class="state-error-text">Unable to reach BSI.</span>
            <button id="healthRetry" class="state-retry-btn" type="button">Retry</button>
          </div>
        </div>
      </div>

      <!-- Job Panel (hidden by default, shown when runnerEnabled) -->
      <div id="jobPanel" class="wc3-job-panel" hidden aria-label="Agent Jobs">
        <div class="wc3-job-header">
          <span class="wc3-job-title">Agent Jobs</span>
          <button id="jobPanelToggle" class="wc3-job-toggle" type="button" aria-label="Toggle job panel" aria-expanded="true">
            <span aria-hidden="true">‚àí</span>
          </button>
        </div>
        <div id="jobPanelContent" class="wc3-job-content">
          <!-- Create Job Form -->
          <form id="jobForm" class="wc3-job-form">
            <input
              type="text"
              id="jobCommand"
              class="wc3-job-input"
              placeholder="Enter command..."
              aria-label="Job command"
              required
            />
            <button type="submit" class="wc3-job-submit" aria-label="Create job">
              <span aria-hidden="true">+</span> Run
            </button>
          </form>
          <!-- Job List -->
          <div id="jobList" class="wc3-job-list" role="list" aria-label="Job list">
            <!-- Loading state -->
            <div id="jobLoading" class="state-container state-loading" hidden>
              <div class="state-loading-spinner" aria-hidden="true"></div>
              <span class="state-loading-text">Loading jobs...</span>
            </div>
            <!-- Empty state -->
            <div id="jobEmpty" class="state-container state-empty">
              <span class="state-empty-icon" aria-hidden="true">üìã</span>
              <span class="state-empty-text">No jobs yet. Create one above.</span>
            </div>
            <!-- Error state -->
            <div id="jobError" class="state-container state-error" hidden>
              <span class="state-error-text">Failed to load jobs.</span>
              <button id="jobRetry" class="state-retry-btn" type="button">Retry</button>
            </div>
          </div>
          <!-- SSE Log Viewer (shown when job selected) -->
          <div id="jobLogs" class="wc3-job-logs" hidden aria-label="Job logs">
            <div class="wc3-job-logs-header">
              <span id="jobLogsTitle" class="wc3-job-logs-title">Job Logs</span>
              <button id="jobLogsClose" class="wc3-job-logs-close" type="button" aria-label="Close logs">√ó</button>
            </div>
            <div id="jobLogsFeed" class="wc3-job-logs-feed" role="log" aria-live="polite"></div>
          </div>
        </div>
        <!-- Runner not available message (when runnerEnabled but runner is down) -->
        <div id="jobUnavailable" class="wc3-job-unavailable" hidden>
          <span class="state-error-icon" aria-hidden="true">‚ö†Ô∏è</span>
          <span>Runner not available</span>
        </div>
      </div>

      <!-- Command Grid (3x3) - WC3 Style with Labels -->
      <div class="wc3-command-panel-3x3">
        <div class="wc3-command-grid-3x3" role="group" aria-label="Commands">
          <button class="wc3-cmd-labeled" data-cmd="stop" data-wc3-sound="click" aria-label="Stop">
            <span class="wc3-cmd-text">Stop</span>
            <span class="wc3-cmd-key">(S)</span>
          </button>
          <button class="wc3-cmd-labeled" data-cmd="hold" data-wc3-sound="click" aria-label="Hold">
            <span class="wc3-cmd-text">Hold</span>
            <span class="wc3-cmd-key">(H)</span>
          </button>
          <button class="wc3-cmd-labeled" data-cmd="resume" data-wc3-sound="click" aria-label="Resume">
            <span class="wc3-cmd-text">Resume</span>
            <span class="wc3-cmd-key">(R)</span>
          </button>

          <button class="wc3-cmd-labeled" data-cmd="reassign" data-wc3-sound="click" aria-label="Reassign">
            <span class="wc3-cmd-text">Reassign</span>
            <span class="wc3-cmd-key">(A)</span>
          </button>
          <button class="wc3-cmd-labeled" data-cmd="inspect" data-wc3-sound="click" aria-label="Inspect">
            <span class="wc3-cmd-text">Inspect</span>
            <span class="wc3-cmd-key">(I)</span>
          </button>
          <button class="wc3-cmd-labeled" data-cmd="logs" data-wc3-sound="click" aria-label="Logs">
            <span class="wc3-cmd-text">Logs</span>
            <span class="wc3-cmd-key">(L)</span>
          </button>

          <button class="wc3-cmd-labeled" data-cmd="focus" data-wc3-sound="click" aria-label="Focus">
            <span class="wc3-cmd-text">Focus</span>
            <span class="wc3-cmd-key">(C)</span>
          </button>
          <button class="wc3-cmd-labeled wc3-cmd-danger" data-cmd="terminate" data-wc3-sound="click" aria-label="Terminate">
            <span class="wc3-cmd-text">Terminate</span>
            <span class="wc3-cmd-key">(X)</span>
          </button>
          <button class="wc3-cmd-labeled" data-cmd="scan" data-wc3-sound="click" aria-label="Scan">
            <span class="wc3-cmd-text">Scan</span>
            <span class="wc3-cmd-key">(Q)</span>
          </button>
        </div>
      </div>

    </section>

  </div>

  <!-- WC3 Tooltip (positioned via JS) -->
  <div id="wc3-tooltip" class="wc3-tooltip" role="tooltip" aria-hidden="true">
    <div class="wc3-tooltip-title"></div>
    <div class="wc3-tooltip-desc"></div>
    <div class="wc3-tooltip-cost"></div>
  </div>

  <!-- WC3 Loading Overlay (for initial connection) -->
  <div id="wc3-loading" class="wc3-loading" style="display: none;" aria-live="polite">
    <div class="wc3-loading-orb"></div>
    <div class="wc3-loading-text">Establishing Connection</div>
  </div>

  <script type="module" src="scripts/main.js"></script>

  <!-- React Gamification UI (Progressive Enhancement) -->
  <link rel="stylesheet" href="src/react/styles/adaptive-ui.css" />
  <script type="module">
    // Initialize React UI after main app is ready
    import { initReactUI } from './src/react/index.jsx';

    // Wait for the main app to initialize
    document.addEventListener('DOMContentLoaded', () => {
      // Delay to ensure main.js has initialized
      setTimeout(() => {
        if (window.blazeGameState) {
          initReactUI(window.blazeGameState);
        }
      }, 100);
    });

    // Also listen for explicit ready event
    window.addEventListener('blazecraft:ready', (e) => {
      initReactUI(e.detail?.gameState || window.blazeGameState);
    });
  </script>

  <!-- WC3 Wisp Particle System -->
  <script>
    (function initWisps() {
      const container = document.getElementById('wc3-wisps');
      if (!container || window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;

      const WISP_COUNT = 15;

      for (let i = 0; i < WISP_COUNT; i++) {
        const wisp = document.createElement('div');
        wisp.className = 'wc3-wisp';
        wisp.style.cssText = `
          left: ${10 + Math.random() * 80}%;
          animation-delay: ${Math.random() * 8}s;
          animation-duration: ${6 + Math.random() * 6}s;
        `;
        container.appendChild(wisp);
      }
    })();
  </script>

  <!-- Welcome Overlay Controller -->
  <script>
    (function initWelcome() {
      const overlay = document.getElementById('welcomeOverlay');
      if (!overlay) return;

      const STORAGE_KEY = 'blazecraft_welcomed';
      const wasWelcomed = localStorage.getItem(STORAGE_KEY) === 'true';

      // Show overlay for first-time visitors
      if (wasWelcomed) {
        overlay.hidden = true;
        return;
      }

      const demoBtn = document.getElementById('welcomeDemo');
      const dismissBtn = document.getElementById('welcomeDismiss');

      function closeOverlay(startDemo = false) {
        overlay.classList.add('dismissed');
        localStorage.setItem(STORAGE_KEY, 'true');

        setTimeout(() => {
          overlay.hidden = true;
          if (startDemo) {
            const toggleDemo = document.getElementById('toggleDemo');
            if (toggleDemo && !toggleDemo.classList.contains('active')) {
              toggleDemo.click();
            }
          }
        }, 300);
      }

      demoBtn?.addEventListener('click', () => closeOverlay(true));
      dismissBtn?.addEventListener('click', () => closeOverlay(false));

      // Close on Escape key
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && !overlay.hidden) {
          closeOverlay(false);
        }
      });

      // Close when clicking outside the card
      overlay.addEventListener('click', (e) => {
        if (e.target === overlay) {
          closeOverlay(false);
        }
      });
    })();
  </script>

  <!-- WC3 Tooltip System -->
  <script>
    (function initTooltips() {
      const tooltip = document.getElementById('wc3-tooltip');
      if (!tooltip) return;

      const tooltipData = {
        stop: { title: 'Stop', desc: 'Halt current task immediately', hotkey: 'S' },
        hold: { title: 'Hold Position', desc: 'Pause execution, maintain state', hotkey: 'H' },
        resume: { title: 'Resume', desc: 'Continue paused execution', hotkey: 'R' },
        reassign: { title: 'Reassign', desc: 'Move worker to new task', hotkey: 'A' },
        inspect: { title: 'Inspect', desc: 'View detailed worker status', hotkey: 'I' },
        terminate: { title: 'Terminate', desc: 'End worker process', hotkey: 'X' },
        logs: { title: 'View Logs', desc: 'Show execution history', hotkey: 'L' },
        files: { title: 'Browse Files', desc: 'Explore workspace files', hotkey: 'F' },
        notes: { title: 'Notes', desc: 'View worker annotations', hotkey: 'N' },
        focus: { title: 'Focus', desc: 'Center view on worker', hotkey: 'C' },
        guard: { title: 'Guard', desc: 'Monitor for changes', hotkey: 'G' },
        scan: { title: 'Scan', desc: 'Analyze workspace', hotkey: 'Q' }
      };

      document.querySelectorAll('[data-cmd]').forEach(btn => {
        btn.addEventListener('mouseenter', (e) => {
          const cmd = btn.dataset.cmd;
          const data = tooltipData[cmd];
          if (!data) return;

          tooltip.querySelector('.wc3-tooltip-title').innerHTML =
            `${data.title} <span class="wc3-tooltip-hotkey">${data.hotkey}</span>`;
          tooltip.querySelector('.wc3-tooltip-desc').textContent = data.desc;
          tooltip.classList.add('visible');

          const rect = btn.getBoundingClientRect();
          tooltip.style.left = `${rect.left}px`;
          tooltip.style.bottom = `${window.innerHeight - rect.top + 8}px`;
        });

        btn.addEventListener('mouseleave', () => {
          tooltip.classList.remove('visible');
        });
      });
    })();
  </script>
</body>
</html>
