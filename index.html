<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BlazeCraft | Blaze Sports Intel</title>
  <meta name="description" content="BlazeCraft: RTS-style console for monitoring and controlling agent sessions." />
  <meta name="theme-color" content="#0b0b0f" />

  <!-- Open Graph -->
  <meta property="og:title" content="BlazeCraft | Blaze Sports Intel" />
  <meta property="og:description" content="RTS-style agent visualization console. Monitor and control Claude Code sessions in real-time." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://blazecraft.app" />

  <!-- Fonts: Plus Jakarta Sans, Cinzel (WC3 display), Lora (WC3 body), JetBrains Mono -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Archivo+Black&family=Cinzel:wght@400;700&family=Cinzel+Decorative:wght@700&family=Lora:ital,wght@0,400;0,600;1,400&family=JetBrains+Mono:wght@400;500;700&family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=MedievalSharp&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="styles/main.css" />
</head>
<body>
  <!-- BSI Film Grain Filter (3.5% opacity, respects prefers-reduced-motion) -->
  <svg class="bsi-grain-defs" aria-hidden="true" style="position:absolute;width:0;height:0;pointer-events:none;">
    <defs>
      <filter id="bsi-grain-filter" x="0%" y="0%" width="100%" height="100%">
        <feTurbulence type="fractalNoise" baseFrequency="0.75" numOctaves="4" stitchTiles="stitch" result="noise"/>
        <feColorMatrix type="saturate" values="0" result="mono"/>
        <feBlend in="SourceGraphic" in2="mono" mode="multiply"/>
      </filter>
    </defs>
  </svg>

  <!-- Film Grain Overlay (can toggle via BSIGrain.disable()) -->
  <div id="bsi-grain-overlay" class="bsi-grain-overlay" aria-hidden="true"></div>

  <!-- WC3 Magical Wisp Particle Container -->
  <div id="wc3-wisps" class="wc3-wisps-container" aria-hidden="true"></div>

  <div id="app" aria-label="BlazeCraft">

    <!-- WC3 Resource Bar (Top) -->
    <header id="topbar" class="panel wc3-resource-bar" role="banner">
      <div class="topbar-left">
        <div class="brand">
          <a class="brand-mark" href="https://blazesportsintel.com/" target="_blank" rel="noopener" aria-label="Open Blaze Sports Intel">
            <img class="brand-logo" src="images/blazecraft-logo.svg" alt="BlazeCraft" width="32" height="36" />
          </a>
        </div>

        <!-- WC3 Resources: Gold, Lumber, Food, Upkeep -->
        <div class="wc3-resources" role="group" aria-label="Resources">
          <div class="wc3-res" title="Gold (API Requests/min)">
            <span class="wc3-res-ico gold" aria-hidden="true"></span>
            <span id="resGold" class="wc3-res-num">0</span>
          </div>
          <div class="wc3-res" title="Lumber (Cache Hit Rate %)">
            <span class="wc3-res-ico lumber" aria-hidden="true"></span>
            <span id="resLumber" class="wc3-res-num">0</span>
            <span class="wc3-res-cap">%</span>
          </div>
          <div class="wc3-res" title="Food (Active Connections)">
            <span class="wc3-res-ico food" aria-hidden="true"></span>
            <span id="resFood" class="wc3-res-num">0</span>
            <span class="wc3-res-cap">/</span>
            <span id="resFoodMax" class="wc3-res-num">50</span>
          </div>
          <div class="wc3-res wc3-res-upkeep" title="Upkeep (Error Rate)">
            <span class="wc3-res-label">Upkeep</span>
            <span id="resUpkeep" class="wc3-res-num upkeep-low">Low</span>
          </div>
        </div>

        <button id="idleAlert" class="idle-alert" type="button" aria-live="polite" hidden>
          <span class="idle-alert-dot" aria-hidden="true"></span>
          <span class="idle-alert-text">Idle</span>
          <span id="idleAlertCount" class="idle-alert-count">0</span>
        </button>
      </div>

      <div class="topbar-right">
        <div class="mode-selector" role="group" aria-label="View mode">
          <button id="modeRTS" class="mode-btn active" type="button" aria-label="RTS mode">RTS</button>
          <button id="modeOps" class="mode-btn" type="button" aria-label="Operations mode">Ops</button>
        </div>
        <button id="toggleLog" class="btn btn-sm" type="button" aria-pressed="false">Log</button>
        <button id="toggleDemo" class="btn btn-accent btn-sm" type="button" aria-pressed="true" title="Toggle demo mode">Demo</button>
      </div>
    </header>

    <!-- WC3 Game Area (Map + Event Log) -->
    <div class="wc3-game-area">
      <!-- Center Map -->
      <main id="mapWrap" class="panel wc3-map-panel" role="main">
        <canvas id="mapCanvas" width="1280" height="720" aria-label="Workspace Map" tabindex="0"></canvas>
        <div id="mapHud" class="hud" aria-hidden="true">
          <div class="hud-row">
            <span class="kbd">Drag</span> select
            <span class="dot">¬∑</span>
            <span class="kbd">RMB</span> assign
            <span class="dot">¬∑</span>
            <span class="kbd">Wheel</span> zoom
            <span class="dot">¬∑</span>
            <span class="kbd">MMB</span> pan
          </div>
        </div>
      </main>

      <!-- Event Log (Right Sidebar) -->
      <aside id="logPanel" class="panel wc3-event-log" aria-label="Event Log">
        <div class="panel-title">
          <span>Event Log</span>
          <span id="logStatus" class="tag tag-live">Live</span>
        </div>
        <div id="logFeed" class="log-feed" role="log" aria-live="polite"></div>
      </aside>
    </div>

    <!-- WC3 Bottom HUD -->
    <section id="bottomHud" class="panel wc3-hud-bottom" aria-label="Bottom HUD">

      <!-- Portrait Panel - Enhanced WC3 Style -->
      <div class="wc3-portrait-panel">
        <div class="wc3-portrait-enhanced" aria-hidden="true">
          <div class="wc3-portrait-inner">
            <div id="portraitIcon" class="wc3-portrait-icon">?</div>
          </div>
        </div>
        <div class="wc3-portrait-info">
          <div id="portraitName" class="wc3-portrait-name">No selection</div>
          <div class="wc3-bar wc3-health-bar" aria-label="Health">
            <div id="portraitHealth" class="wc3-bar-fill" style="width: 100%"></div>
          </div>
          <div id="portraitStatus" class="wc3-portrait-status">Select a worker</div>
        </div>
      </div>

      <!-- Minimap Panel -->
      <div class="wc3-minimap-panel">
        <div class="wc3-minimap-frame">
          <canvas id="minimapCanvas" width="180" height="140" aria-label="Minimap"></canvas>
        </div>
        <div class="wc3-minimap-btns" role="group" aria-label="Minimap controls">
          <button class="wc3-minimap-btn" data-action="terrain" aria-label="Toggle terrain view">Ter</button>
          <button class="wc3-minimap-btn" data-action="units" aria-label="Toggle unit view">Unit</button>
          <button class="wc3-minimap-btn" data-action="ping" aria-label="Ping location">Ping</button>
        </div>
      </div>

      <!-- Ops Feed Panel -->
      <div id="opsPanel" class="wc3-ops-panel">
        <div class="wc3-ops-header">
          <span class="wc3-ops-title">Ops Feed</span>
          <span id="opsStatus" class="tag tag-live">Live</span>
        </div>
        <div id="opsFeed" class="wc3-ops-feed">
          <div class="wc3-ops-loading" aria-label="Loading connection">
            <div class="skeleton-line"></div>
            <div class="skeleton-line short"></div>
          </div>
        </div>
        <div class="wc3-ops-stats">
          <div class="wc3-ops-stat">
            <span class="wc3-ops-stat-label">Latency</span>
            <span id="opsLatency" class="wc3-ops-stat-val">--</span>
          </div>
          <div class="wc3-ops-stat">
            <span class="wc3-ops-stat-label">Events</span>
            <span id="opsEvents" class="wc3-ops-stat-val">0</span>
          </div>
          <div class="wc3-ops-stat">
            <span class="wc3-ops-stat-label">Errors</span>
            <span id="opsErrors" class="wc3-ops-stat-val">0</span>
          </div>
        </div>
      </div>

      <!-- Command Grid (4x3) - Enhanced WC3 Ability Buttons -->
      <div class="wc3-command-panel">
        <div class="wc3-command-grid" role="group" aria-label="Commands">
          <button class="wc3-cmd wc3-cmd-enhanced" data-cmd="stop" data-wc3-sound="click" aria-label="Stop">
            <span class="wc3-cmd-icon" aria-hidden="true">‚èπ</span>
            <span class="wc3-cmd-hotkey">S</span>
          </button>
          <button class="wc3-cmd wc3-cmd-enhanced" data-cmd="hold" data-wc3-sound="click" aria-label="Hold">
            <span class="wc3-cmd-icon" aria-hidden="true">‚è∏</span>
            <span class="wc3-cmd-hotkey">H</span>
          </button>
          <button class="wc3-cmd wc3-cmd-enhanced" data-cmd="resume" data-wc3-sound="click" aria-label="Resume">
            <span class="wc3-cmd-icon" aria-hidden="true">‚ñ∂</span>
            <span class="wc3-cmd-hotkey">R</span>
          </button>
          <button class="wc3-cmd wc3-cmd-enhanced" data-cmd="reassign" data-wc3-sound="click" aria-label="Reassign">
            <span class="wc3-cmd-icon" aria-hidden="true">‚áÑ</span>
            <span class="wc3-cmd-hotkey">A</span>
          </button>

          <button class="wc3-cmd wc3-cmd-enhanced" data-cmd="inspect" data-wc3-sound="click" aria-label="Inspect">
            <span class="wc3-cmd-icon" aria-hidden="true">üîé</span>
            <span class="wc3-cmd-hotkey">I</span>
          </button>
          <button class="wc3-cmd wc3-cmd-enhanced" data-cmd="terminate" data-wc3-sound="click" aria-label="Terminate">
            <span class="wc3-cmd-icon" aria-hidden="true">‚úñ</span>
            <span class="wc3-cmd-hotkey">X</span>
          </button>
          <button class="wc3-cmd wc3-cmd-enhanced" data-cmd="logs" data-wc3-sound="click" aria-label="View Logs">
            <span class="wc3-cmd-icon" aria-hidden="true">üìã</span>
            <span class="wc3-cmd-hotkey">L</span>
          </button>
          <button class="wc3-cmd wc3-cmd-enhanced" data-cmd="files" data-wc3-sound="click" aria-label="View Files">
            <span class="wc3-cmd-icon" aria-hidden="true">üìÅ</span>
            <span class="wc3-cmd-hotkey">F</span>
          </button>

          <button class="wc3-cmd wc3-cmd-enhanced" data-cmd="notes" data-wc3-sound="click" aria-label="Notes">
            <span class="wc3-cmd-icon" aria-hidden="true">üí¨</span>
            <span class="wc3-cmd-hotkey">N</span>
          </button>
          <button class="wc3-cmd wc3-cmd-enhanced" data-cmd="focus" data-wc3-sound="click" aria-label="Focus">
            <span class="wc3-cmd-icon" aria-hidden="true">üéØ</span>
            <span class="wc3-cmd-hotkey">C</span>
          </button>
          <button class="wc3-cmd wc3-cmd-enhanced" data-cmd="guard" data-wc3-sound="click" aria-label="Guard">
            <span class="wc3-cmd-icon" aria-hidden="true">üõ°</span>
            <span class="wc3-cmd-hotkey">G</span>
          </button>
          <button class="wc3-cmd wc3-cmd-enhanced" data-cmd="scan" data-wc3-sound="click" aria-label="Scan">
            <span class="wc3-cmd-icon" aria-hidden="true">üì°</span>
            <span class="wc3-cmd-hotkey">Q</span>
          </button>
        </div>
      </div>

    </section>

  </div>

  <!-- WC3 Tooltip (positioned via JS) -->
  <div id="wc3-tooltip" class="wc3-tooltip" role="tooltip" aria-hidden="true">
    <div class="wc3-tooltip-title"></div>
    <div class="wc3-tooltip-desc"></div>
    <div class="wc3-tooltip-cost"></div>
  </div>

  <!-- WC3 Loading Overlay (for initial connection) -->
  <div id="wc3-loading" class="wc3-loading" style="display: none;" aria-live="polite">
    <div class="wc3-loading-orb"></div>
    <div class="wc3-loading-text">Establishing Connection</div>
  </div>

  <script type="module" src="scripts/main.js"></script>

  <!-- WC3 Wisp Particle System -->
  <script>
    (function initWisps() {
      const container = document.getElementById('wc3-wisps');
      if (!container || window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;

      const WISP_COUNT = 15;

      for (let i = 0; i < WISP_COUNT; i++) {
        const wisp = document.createElement('div');
        wisp.className = 'wc3-wisp';
        wisp.style.cssText = `
          left: ${10 + Math.random() * 80}%;
          animation-delay: ${Math.random() * 8}s;
          animation-duration: ${6 + Math.random() * 6}s;
        `;
        container.appendChild(wisp);
      }
    })();
  </script>

  <!-- WC3 Tooltip System -->
  <script>
    (function initTooltips() {
      const tooltip = document.getElementById('wc3-tooltip');
      if (!tooltip) return;

      const tooltipData = {
        stop: { title: 'Stop', desc: 'Halt current task immediately', hotkey: 'S' },
        hold: { title: 'Hold Position', desc: 'Pause execution, maintain state', hotkey: 'H' },
        resume: { title: 'Resume', desc: 'Continue paused execution', hotkey: 'R' },
        reassign: { title: 'Reassign', desc: 'Move worker to new task', hotkey: 'A' },
        inspect: { title: 'Inspect', desc: 'View detailed worker status', hotkey: 'I' },
        terminate: { title: 'Terminate', desc: 'End worker process', hotkey: 'X' },
        logs: { title: 'View Logs', desc: 'Show execution history', hotkey: 'L' },
        files: { title: 'Browse Files', desc: 'Explore workspace files', hotkey: 'F' },
        notes: { title: 'Notes', desc: 'View worker annotations', hotkey: 'N' },
        focus: { title: 'Focus', desc: 'Center view on worker', hotkey: 'C' },
        guard: { title: 'Guard', desc: 'Monitor for changes', hotkey: 'G' },
        scan: { title: 'Scan', desc: 'Analyze workspace', hotkey: 'Q' }
      };

      document.querySelectorAll('[data-cmd]').forEach(btn => {
        btn.addEventListener('mouseenter', (e) => {
          const cmd = btn.dataset.cmd;
          const data = tooltipData[cmd];
          if (!data) return;

          tooltip.querySelector('.wc3-tooltip-title').innerHTML =
            `${data.title} <span class="wc3-tooltip-hotkey">${data.hotkey}</span>`;
          tooltip.querySelector('.wc3-tooltip-desc').textContent = data.desc;
          tooltip.classList.add('visible');

          const rect = btn.getBoundingClientRect();
          tooltip.style.left = `${rect.left}px`;
          tooltip.style.bottom = `${window.innerHeight - rect.top + 8}px`;
        });

        btn.addEventListener('mouseleave', () => {
          tooltip.classList.remove('visible');
        });
      });
    })();
  </script>
</body>
</html>
